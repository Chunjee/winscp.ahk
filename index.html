<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">

    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-dark.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print">

    <title>Winscp.ahk by lipkau</title>
  </head>

  <body>

    <header>
      <div class="container">
        <h1>Winscp.ahk</h1>
        <h2>Lib allows the use of WinSCP in AHK</h2>

        <section id="downloads">
          <a href="https://github.com/lipkau/WinSCP.ahk/zipball/master" class="btn">Download as .zip</a>
          <a href="https://github.com/lipkau/WinSCP.ahk/tarball/master" class="btn">Download as .tar.gz</a>
          <a href="https://github.com/lipkau/WinSCP.ahk" class="btn btn-github"><span class="icon"></span>View on GitHub</a>
        </section>
      </div>
    </header>

    <div class="container">
      <section id="main_content">
        <h1>
<a id="winscpahk" class="anchor" href="#winscpahk" aria-hidden="true"><span class="octicon octicon-link"></span></a>WinSCP.ahk</h1>

<h2>
<a id="description" class="anchor" href="#description" aria-hidden="true"><span class="octicon octicon-link"></span></a>Description</h2>

<p>This Lib allows the use of <a href="http://winscp.net/">WinSCP</a> in AHK by creating a wrapper class for WinSCPnet.dll (can be donwloaded <a href="http://winscp.net/eng/download.php">here</a>).  </p>

<blockquote>
<p><a href="http://winscp.net/eng/docs/library">WinSCP .NET &amp; COM Library Documentation</a>  </p>
</blockquote>

<h2>
<a id="table-of-contents" class="anchor" href="#table-of-contents" aria-hidden="true"><span class="octicon octicon-link"></span></a>Table of Contents</h2>

<ul>
<li><a href="#description">Description</a></li>
<li><a href="#example">Example</a></li>
<li><a href="#authorscontributors">Authors/Contributors</a></li>
<li><a href="#documentation">Documentation</a></li>
</ul>

<h2>
<a id="example" class="anchor" href="#example" aria-hidden="true"><span class="octicon octicon-link"></span></a>Example</h2>

<h3>
<a id="loading-winscpahk" class="anchor" href="#loading-winscpahk" aria-hidden="true"><span class="octicon octicon-link"></span></a>Loading WinSCP.ahk</h3>

<ol>
<li>
<p><strong>The DLL file has to be registered</strong>. This is done with  </p>

<p>%WINDIR%\Microsoft.NET\Framework\v4.0.30319\RegAsm.exe WinSCPnet.dll /codebase WinSCPnet.dll
  %WINDIR%\Microsoft.NET\Framework64\v4.0.30319\RegAsm.exe WinSCPnet.dll /codebase WinSCPnet.dll  </p>
</li>
</ol>

<p>or by running the included <code>WinSCP_regDLL.cmd</code> file<br>
<em>The commands must be run with Admin permissions (elevated)</em><br>
2. The library can be included using <a href="http://ahkscript.org/docs/commands/_Include.htm">#Inclulde</a> or by placing the file inside <a href="http://ahkscript.org/docs/Functions.htm#lib">Library Folders</a>.  </p>

<h3>
<a id="connecting-to-server" class="anchor" href="#connecting-to-server" aria-hidden="true"><span class="octicon octicon-link"></span></a>Connecting to Server</h3>

<h4>
<a id="using-normal-ftp" class="anchor" href="#using-normal-ftp" aria-hidden="true"><span class="octicon octicon-link"></span></a>Using normal FTP</h4>

<pre><code>  FTPSession := new WinSCP
  try
    FTPSession.OpenConnection("ftp://myserver.com","username","password")
  catch e
    msgbox % "Oops. . . Something went wrong``n" e.Message
</code></pre>

<h4>
<a id="using-ftp-with-ssl" class="anchor" href="#using-ftp-with-ssl" aria-hidden="true"><span class="octicon octicon-link"></span></a>Using FTP with SSL</h4>

<pre><code>  FTPSession := new WinSCP
  try
  {
    FTPSession.Hostname     := "ftp://myserver.com"
    FTPSession.Protocol         := WinSCPEnum.FtpProtocol.Ftp
    FTPSession.Secure       := WinSCPEnum.FtpSecure.ExplicitSsl
    FTPSession.User         := "MyUserName"
    FTPSession.Password     := "P@ssw0rd"
    FTPSession.Fingerprint    := "xx:xx:xx:xx:xx:xx:xx:xx:xx:xx:xx:xx:xx:xx:xx:xx:xx:xx:xx:xx" ;set to false to ignore server certificate
    FTPSession.OpenConnection()
  } catch e
    msgbox % "Oops. . . Something went wrong``n" e.Message
</code></pre>

<h3>
<a id="handling-files" class="anchor" href="#handling-files" aria-hidden="true"><span class="octicon octicon-link"></span></a>Handling files</h3>

<h4>
<a id="upload-a-single-file" class="anchor" href="#upload-a-single-file" aria-hidden="true"><span class="octicon octicon-link"></span></a>Upload a single file</h4>

<pre><code>  FTPSession := new WinSCP
  try
  {
    FTPSession.OpenConnection("ftp://myserver.com","username","password")

    fName := "Windows10_InsiderPreview_x64_EN-US_10074.iso"
    fPath := "C:\temp"
    tPath := "/Win10beta/"
    if (!FTPSession.FileExists(tPath))
      FTPSession.CreateDirectory(tPath)
    FTPSession.PutFiles(fPath "\" fName, tPath)
  } catch e
    msgbox % "Oops. . . Something went wrong``n" e.Message  
</code></pre>

<h4>
<a id="download-file" class="anchor" href="#download-file" aria-hidden="true"><span class="octicon octicon-link"></span></a>Download file</h4>

<pre><code>  FTPSession := new WinSCP
  try
  {
    FTPSession.OpenConnection("ftp://myserver.com","username","password")

    fName := "Windows10_InsiderPreview_x64_EN-US_10074.iso"
    lPath := "C:\temp"
    rPath := "/Win10beta/"
    if (FTPSession.FileExists(rPath "/" fName))
      FTPSession.GetFiles(rPath "/" fName, lPath)
  } catch e
    msgbox % "Oops. . . Something went wrong``n" e.Message  
</code></pre>

<h4>
<a id="get-file-information" class="anchor" href="#get-file-information" aria-hidden="true"><span class="octicon octicon-link"></span></a>Get File Information</h4>

<pre><code>  FTPSession := new WinSCP
  try
  {
    FTPSession.OpenConnection("ftp://myserver.com","username","password")

    FileCollection := t.ListDirectory("/")
    for file in FileCollection.Files {
      if (file.Name != "." &amp;&amp; file.Name != "..")
        msgbox % "Name: " file.Name "``nPermission: " file.FilePermissions.Octal "``nIsDir: " file.IsDirectory "``nFileType: " file.FileType "``nGroup: " file.Group "``nLastWriteTime: " file.LastWriteTime "``nLength: " file.Length "``nLength32: " file.Length32 "``nOwner: " file.Owner
  } catch e
    msgbox % "Oops. . . Something went wrong``n" e.Message 
</code></pre>

<h3>
<a id="more" class="anchor" href="#more" aria-hidden="true"><span class="octicon octicon-link"></span></a>More</h3>

<p>More example will be available in the <a href="wiki">wiki</a> once it's set up</p>

<h2>
<a id="authorscontributors" class="anchor" href="#authorscontributors" aria-hidden="true"><span class="octicon octicon-link"></span></a>Authors/Contributors</h2>

<ul>
<li>"Oliver Lipkau" @ <a href="http://oliver.lipkau.net">oliver.lipkau.net</a>
</li>
</ul>

<h2>
<a id="documentation" class="anchor" href="#documentation" aria-hidden="true"><span class="octicon octicon-link"></span></a>Documentation</h2>

<p><em>Git Repo Wiki yet to be written</em></p>
      </section>
    </div>

              <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-64222060-1");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>

  </body>
</html>
