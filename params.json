{"name":"Winscp.ahk","tagline":"Lib allows the use of WinSCP in AHK","body":"# WinSCP.ahk  \r\n## <a name=\"desc\"></a>Description\r\nThis Lib allows the use of [WinSCP](http://winscp.net/) in AHK by creating a wrapper class for WinSCPnet.dll (can be donwloaded [here](http://winscp.net/eng/download.php)).  \r\n> [WinSCP .NET & COM Library Documentation](http://winscp.net/eng/docs/library)  \r\n\r\n## Table of Contents  \r\n* [Description](#desc)\r\n* [Authors/Contributors](#dev-team)\r\n* [Example](#usage)\r\n* [Documentation](#doc)\r\n\r\n## <a name=\"usage\"></a>Example  \r\n\r\n### Loading WinSCP.ahk\r\n1. **The DLL file has to be registered**. This is done with  \r\n      %WINDIR%\\Microsoft.NET\\Framework\\v4.0.30319\\RegAsm.exe WinSCPnet.dll /codebase <path_to>WinSCPnet.dll\r\n      %WINDIR%\\Microsoft.NET\\Framework64\\v4.0.30319\\RegAsm.exe WinSCPnet.dll /codebase <path_to>WinSCPnet.dll  \r\nor by running the included `WinSCP_regDLL.cmd` file  \r\n> The commands must be run with Admin permissions (elevated)  \r\n2. The library can be included using [#Inclulde](http://ahkscript.org/docs/commands/_Include.htm) or by placing the file inside [Library Folders](http://ahkscript.org/docs/Functions.htm#lib).  \r\n\r\n### Connecting to Server  \r\n> Using normal FTP  \r\n\r\n      FTPSession := new WinSCP\r\n\t  try\r\n\t    FTPSession.OpenConnection(\"ftp://myserver.com\",\"username\",\"password\")\r\n\t  } catch e\r\n\t    msgbox % \"Oops. . . Something went wrong``n\" e.Message\r\n\r\n> Using FTP with SSL  \r\n\r\n      FTPSession := new WinSCP\r\n\t  try\r\n\t  {\r\n        FTPSession.Hostname\t\t:= \"ftp://myserver.com\"\r\n        FTPSession.Protocol \t\t:= WinSCPEnum.FtpProtocol.Ftp\r\n        FTPSession.Secure \t\t:= WinSCPEnum.FtpSecure.ExplicitSsl\r\n        FTPSession.User\t\t\t:= \"MyUserName\"\r\n        FTPSession.Password\t\t:= \"P@ssw0rd\"\r\n        FTPSession.Fingerprint    := \"xx:xx:xx:xx:xx:xx:xx:xx:xx:xx:xx:xx:xx:xx:xx:xx:xx:xx:xx:xx\" ;set to false to ignore server certificate\r\n\t\tFTPSession.OpenConnection()\r\n      } catch e\r\n\t    msgbox % \"Oops. . . Something went wrong``n\" e.Message\r\n\r\n### Handling files  \r\n> Upload a single file  \r\n\r\n      FTPSession := new WinSCP\r\n\t  try\r\n\t  {\r\n        FTPSession.OpenConnection(\"ftp://myserver.com\",\"username\",\"password\")\r\n\t    \r\n\t    fName := \"Windows10_InsiderPreview_x64_EN-US_10074.iso\"\r\n\t    fPath := \"C:\\temp\"\r\n\t\ttPath := \"/Win10beta/\"\r\n\t\tif (!FTPSession.FileExists(tPath))\r\n\t\t  FTPSession.CreateDirectory(tPath)\r\n\t    FTPSession.PutFiles(fPath \"\\\" fName, tPath)\r\n\t  } catch e\r\n\t    msgbox % \"Oops. . . Something went wrong``n\" e.Message  \r\n\r\n> Download file  \r\n\r\n      FTPSession := new WinSCP\r\n\t  try\r\n\t  {\r\n        FTPSession.OpenConnection(\"ftp://myserver.com\",\"username\",\"password\")\r\n\t    \r\n\t    fName := \"Windows10_InsiderPreview_x64_EN-US_10074.iso\"\r\n\t    lPath := \"C:\\temp\"\r\n\t\trPath := \"/Win10beta/\"\r\n\t\tif (FTPSession.FileExists(rPath \"/\" fName))\r\n\t      FTPSession.GetFiles(rPath \"/\" fName, lPath)\r\n\t  } catch e\r\n\t    msgbox % \"Oops. . . Something went wrong``n\" e.Message  \r\n\t\t\r\n> Get File Information  \r\n\r\n      FTPSession := new WinSCP\r\n\t  try\r\n\t  {\r\n        FTPSession.OpenConnection(\"ftp://myserver.com\",\"username\",\"password\")\r\n\t    \r\n\t    FileCollection := t.ListDirectory(\"/\")\r\n\t    for file in FileCollection.Files {\r\n\t\t  if (file.Name != \".\" && file.Name != \"..\")\r\n            msgbox % \"Name: \" file.Name \"``nPermission: \" file.FilePermissions.Octal \"``nIsDir: \" file.IsDirectory \"``nFileType: \" file.FileType \"``nGroup: \" file.Group \"``nLastWriteTime: \" file.LastWriteTime \"``nLength: \" file.Length \"``nLength32: \" file.Length32 \"``nOwner: \" file.Owner\r\n\t  } catch e\r\n\t    msgbox % \"Oops. . . Something went wrong``n\" e.Message \r\n\r\n### More  \r\nMore example will be available in the [wiki](wiki) once it's set up\r\n\r\n## <a name=\"dev-team\"></a>Authors/Contributors  \r\n* \"Oliver Lipkau\" @ [oliver.lipkau.net](http://oliver.lipkau.net)\r\n\r\n## <a name=\"doc\"></a>Documentation\r\n_Git Repo Wiki yet to be written_","google":"UA-64222060-1","note":"Don't delete this file! It's used internally to help with page regeneration."}